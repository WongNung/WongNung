{% extends "wongnung/wongnung_page.html" %}
{% load i18n %}
{% load allauth %}
{% block t %}Two-Factor Authentication Activation{% endblock t %}
{% block c %}
<div class="flex items-center justify-center w-full pt-5">
    <div class="box-content w-[450px] h-fit bg-regis-grey rounded-2xl flex flex-col py-10">
            <div class="font-primary text-4xl text-black mb-2 drop-shadow-lg self-center">
                2FA Activation
            </div>
            <div class="self-center">
                <div class="flex flex-col items-center">
                    <p class="w-5/6 text-center">
                        To protect your account with two-factor authentication, scan the QR code below with your authenticator app. Then, input the verification code generated by the app below.
                    </p>
                    {% url 'mfa_activate_totp' as action_url %}
                    <form method="POST" action={{ action_url }} class="mt-4 flex flex-col items-center">
                        {% csrf_token %}
                        <div class="bg-white p-1 w-fit">
                            {% element img src=totp_svg_data_uri alt=form.secret %}
                            {% endelement %}
                        </div>
                        <p class="flex flex-row mt-2 w-full items-baseline justify-between gap-2">
                            <label title="You can store this secret and use it to reinstall your authenticator app at a later time."
                                for="authenticator_secret">Authenticator secret</label>
                            <input disabled id="authenticator_secret" value={{form.secret}} type="text">
                        </p>
                        <p class="flex flex-row mt-2 w-full items-baseline justify-between gap-2">
                            <label for="id_code">Authenticator code</label>
                            <input id="id_code" name="code" required placeholder="Code" autocomplete="one-time-code" type="text">
                        </p>
                        <button type="submit"
                                class="h-10 w-80 m-2 px-3 bg-component-red text-white font-primary text-lg text-center rounded-xl hover:drop-shadow-md p-2">
                            Activate
                        </button>
                    </form>
                </div>
            </div>
    </div>
</div>
{% endblock c %}